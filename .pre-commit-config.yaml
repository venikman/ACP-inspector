repos:
  - repo: local
    hooks:
      - id: fantomas
        name: Fantomas F# Formatter
        entry: bash -c 'dotnet tool restore > /dev/null 2>&1 && dotnet fantomas --check cli/apps cli/src runtime/src protocol/src sentinel/src sentinel/tests'
        language: system
        files: \.(fs|fsx|fsi)$
        exclude: ^(sentinel/tests/golden/|.*obj/.*|.*\.AssemblyInfo\.fs)
        pass_filenames: false

      - id: dotnet-test-main
        name: Run ACP.Tests (main test suite)
        entry: bash -c 'dotnet test sentinel/tests/ACP.Tests.fsproj --configuration Release --logger "console;verbosity=minimal"'
        language: system
        files: \.(fs|fsx|fsi|fsproj)$
        pass_filenames: false

      - id: dotnet-test-epistemology
        name: Run Epistemology.Harness tests
        entry: bash -c 'dotnet test sentinel/tests/Epistemology.Harness/Epistemology.Harness.fsproj --configuration Release --logger "console;verbosity=minimal"'
        language: system
        files: \.(fs|fsx|fsi|fsproj)$
        pass_filenames: false

      - id: dotnet-test-validation
        name: Run Validation.Harness tests
        entry: bash -c 'dotnet test sentinel/tests/Validation.Harness/Validation.Harness.fsproj --configuration Release --logger "console;verbosity=minimal"'
        language: system
        files: \.(fs|fsx|fsi|fsproj)$
        pass_filenames: false

      - id: dotnet-test-sdk
        name: Run SDK.Harness tests
        entry: bash -c 'dotnet test sentinel/tests/SDK.Harness/SDK.Harness.fsproj --configuration Release --logger "console;verbosity=minimal"'
        language: system
        files: \.(fs|fsx|fsi|fsproj)$
        pass_filenames: false

      - id: markdownlint
        name: Markdownlint (bunx markdownlint-cli2)
        entry: bash -c 'BUN_INSTALL_BACKEND=copyfile bunx markdownlint-cli2 --config .markdownlint-cli2.yaml'
        language: system
        files: \.(md|markdown)$
        exclude: ^\.codex/

      - id: links
        name: Link check (lychee)
        entry: lychee --config lychee.toml
        language: system
        files: \.(md|markdown)$
        exclude: ^\.codex/
